<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>시니어 유튜브 트렌드 추적</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>시니어층 유튜브 트렌드 추적 시스템</h1>
            <p class="subtitle">한국 시니어층이 실제로 소비하는 트렌딩 영상을 SeniorScore로 필터링</p>
        </header>

        <!-- 통계 대시보드 -->
        <section class="stats-panel">
            <div class="stat-card">
                <h3>전체 비디오</h3>
                <p class="stat-value" id="stat-videos">-</p>
            </div>
            <div class="stat-card">
                <h3>스냅샷</h3>
                <p class="stat-value" id="stat-snapshots">-</p>
            </div>
            <div class="stat-card">
                <h3>라벨링</h3>
                <p class="stat-value" id="stat-labels">-</p>
            </div>
            <div class="stat-card">
                <h3>최신 수집일</h3>
                <p class="stat-value" id="stat-latest">-</p>
            </div>
        </section>

        <!-- 데이터 수집 패널 -->
        <section class="collect-panel">
            <h2>
                📊 데이터 수집
                <button class="toggle-btn" onclick="toggleSection('collect-panel')">▼</button>
            </h2>
            <div class="form-group">
                <label>카테고리 선택 (복수 선택 가능):</label>
                <div id="categories-list" class="checkbox-group">
                    <p>로딩 중...</p>
                </div>
            </div>
            <div class="form-group">
                <label>카테고리당 수집 수:</label>
                <input type="number" id="max-results" value="50" min="1" max="50">
            </div>
            <div class="info-text" style="margin-bottom: 15px;">
                💡 수집은 항상 <strong>오늘 날짜</strong>로 저장됩니다. 과거 조회는 아래 "비디오 조회" 섹션에서 가능합니다.
            </div>
            <button id="btn-collect" class="btn-primary">수집 시작</button>
            <div id="collect-status" class="status-message"></div>
        </section>

        <!-- 비디오 조회 패널 -->
        <section class="view-panel">
            <h2>🎬 비디오 조회</h2>
            <div class="filter-row">
                <div class="form-group">
                    <label>데이터 소스:</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="data-source" value="channel" checked>
                            채널 기반
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="data-source" value="category">
                            카테고리 기반
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="data-source" value="all">
                            전체 보기
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label>조회 날짜:</label>
                    <input type="date" id="view-date" value="">
                </div>
            </div>
            <div class="form-group">
                <label>
                    카테고리 필터 (선택된 카테고리만 표시):
                    <button id="btn-select-all-filters" class="btn-small" style="margin-left: 10px;">전체 선택</button>
                    <button id="btn-deselect-all-filters" class="btn-small">전체 해제</button>
                </label>
                <div id="category-filters" class="checkbox-group">
                    <p style="color: #888;">날짜를 선택하면 수집된 카테고리가 표시됩니다.</p>
                </div>
            </div>
            <div id="video-count" class="info-text"></div>
        </section>

        <!-- ViewScore 가중치 조정 패널 -->
        <section class="weight-panel">
            <h3>
                ⚙️ ViewScore 가중치 조정 (파인튜닝)
                <button class="toggle-btn" onclick="toggleSection('weight-panel')">▼</button>
            </h3>
            <div class="weight-controls">
                <div class="weight-slider">
                    <label>👁️ 조회수: <span id="view-weight-val">1.0</span></label>
                    <input type="range" id="view-weight" min="0" max="5" step="0.1" value="1.0">
                </div>
                <div class="weight-slider">
                    <label>👥 구독자 (언더독 보너스): <span id="subscriber-weight-val">1.0</span></label>
                    <input type="range" id="subscriber-weight" min="0" max="5" step="0.1" value="1.0">
                </div>
                <div class="weight-slider">
                    <label>📅 최신성: <span id="recency-weight-val">1.0</span></label>
                    <input type="range" id="recency-weight" min="0" max="5" step="0.1" value="1.0">
                </div>
                <div class="weight-slider">
                    <label>💬 참여도 (좋아요+댓글): <span id="engagement-weight-val">1.0</span></label>
                    <input type="range" id="engagement-weight" min="0" max="5" step="0.1" value="1.0">
                </div>
                <div style="display: flex; gap: 10px;">
                    <button id="btn-recalculate" class="btn-secondary">재계산</button>
                    <button id="btn-save-weights" class="btn-secondary">저장</button>
                </div>
            </div>
        </section>

        <!-- 비디오 테이블 -->
        <section class="video-table-container">
            <table id="video-table">
                <thead>
                    <tr>
                        <th>순위</th>
                        <th>썸네일</th>
                        <th>제목</th>
                        <th>채널</th>
                        <th class="sortable" data-sort="view_count">
                            조회수 <span class="sort-arrow"></span>
                        </th>
                        <th class="sortable active" data-sort="view_score">
                            ViewScore <span class="sort-arrow">▼</span>
                        </th>
                        <th>Breakdown</th>
                        <th class="sortable" data-sort="delta_views_14d">
                            Δviews (14일) <span class="sort-arrow"></span>
                        </th>
                    </tr>
                </thead>
                <tbody id="video-table-body">
                    <tr>
                        <td colspan="8" class="empty-state">
                            조회 버튼을 눌러 데이터를 불러오세요
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- 푸터 -->
        <footer>
            <p>
                <a href="/channels">📺 채널 관리</a> |
                <a href="/labeling">라벨링 페이지</a> |
                <a href="https://github.com" target="_blank">GitHub</a>
            </p>
        </footer>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
